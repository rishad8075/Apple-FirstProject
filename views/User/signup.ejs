<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

</head>
<body>

    <header>
        
        <%- include("../partials/header.ejs") %>

    </header>

    
    <div class="container d-flex justify-content-center align-items-center vh-100">
        <div class="row w-100">
            <div class="col-md-6 d-none d-md-block">
                
            </div>
            <div class="col-md-6 p-5">
                <h2>Create an Account</h2>
                <% if (typeof errorMessage !== 'undefined' && errorMessage) { %>
                    <div class="alert alert-danger"><%= errorMessage %></div>
                <% } %>
                <form method="post" action="/signup">
                   <div id="error1" style="color: red;font-size: medium;"></div>
                    <input type="text" class="form-control my-2" placeholder="Name" name="name" id="name">
                    <div id="error2" style="color: red;font-size: medium;"></div>
                    <input type="text" class="form-control my-2" placeholder="Phone Number" name="phoneNumber" id="phoneNumber">
                    <div id="error3" style="color: red;font-size: medium;"></div>
                    <input type="email" class="form-control my-2" placeholder="Email" name="email" id="email">
                   <div id="error4" style="color: red;font-size: medium;"></div>
                    <div class="input-group my-2">
                        <input type="password" class="form-control" placeholder="Password" name="password" id="password">
                        <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('password', this)">
                            üëÅÔ∏è
                        </button>
                    </div>
                    
                 <div id="error5" style="color: red;font-size: medium;"></div>
                    <div class="input-group my-2">
                        <input type="password" class="form-control" placeholder="Confirm Password" name="confirmPassword" id="confirmPassword">
                        <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('confirmPassword', this)">
                            üëÅÔ∏è
                        </button>
                    </div>
                    <button class="btn btn-danger w-100">Create Account</button>
                    <a href="/auth/google" class="btn btn-light w-100 mt-2">Sign up with Google</a>
                    <p class="mt-3">Already have an account? <a href="/login">Log in</a></p>
                </form>
            </div>
        </div>
    </div>

    <footer>
        <%- include("../partials/footer.ejs") %>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script>
const nameField = document.getElementById("name");
const phoneNumber = document.getElementById("phoneNumber");
const email = document.getElementById("email");
const password = document.getElementById("password");
const confirmPassword = document.getElementById("confirmPassword");

const error1 = document.getElementById("error1");
const error2 = document.getElementById("error2");
const error3 = document.getElementById("error3");
const error4 = document.getElementById("error4");
const error5 = document.getElementById("error5");

function togglePassword(fieldId, button) {
    const field = document.getElementById(fieldId);
    field.type = field.type === "password" ? "text" : "password";
    button.textContent = field.type === "password" ? "üëÅÔ∏è" : "HIDE";
}

// Remove error when typing
function clearError(field, errorBox) {
    field.classList.remove("border-danger");
    errorBox.textContent = "";
}

// Show error
function showError(field, errorBox, message) {
    field.classList.add("border-danger");
    errorBox.textContent = message;
}

// Attach live listeners
nameField.addEventListener("input", () => {
    if (nameField.value.trim().length >= 3 && /^[A-Za-z ]+$/.test(nameField.value)) {
        clearError(nameField, error1);
    }
});

phoneNumber.addEventListener("input", () => {
    if (/^[6-9]\d{9}$/.test(phoneNumber.value.trim())) {
        clearError(phoneNumber, error2);
    }
});

email.addEventListener("input", () => {
    if (/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email.value.trim())) {
        clearError(email, error3);
    }
});

password.addEventListener("input", () => {
    if (password.value.length >= 6) {
        clearError(password, error4);
    }
});

confirmPassword.addEventListener("input", () => {
    if (confirmPassword.value === password.value) {
        clearError(confirmPassword, error5);
    }
});


document.querySelector("form").addEventListener("submit", function (e) {
    let isValid = true;


    error1.textContent = "";
    error2.textContent = "";
    error3.textContent = "";
    error4.textContent = "";
    error5.textContent = "";

   
    const nameRegex = /^[A-Za-z ]+$/;
    if (nameField.value.trim().length < 3) {
        error1.textContent = "Name must be at least 3 characters long.";
        isValid = false;
    } else if (!nameRegex.test(nameField.value.trim())) {
        error1.textContent = "Name should contain only alphabets and spaces.";
        isValid = false;
    }

   
    const phoneRegex = /^[6-9]\d{9}/;
    if (!phoneRegex.test(phoneNumber.value.trim())) {
        error2.textContent = "Enter a valid 10-digit Indian phone number.";
        isValid = false;
    }

   
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email.value.trim())) {
        error3.textContent = "Enter a valid email address.";
        isValid = false;
    }

   
    if (password.value.length < 6) {
        error4.textContent = "Password must be at least 6 characters long.";
        isValid = false;
    }

    if (password.value !== confirmPassword.value) {
        error5.textContent = "Passwords do not match.";
        isValid = false;
    }

    if (!isValid) {
        e.preventDefault();
    }
});
</script>


</body>
</html>